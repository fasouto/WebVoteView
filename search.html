<!DOCTYPE html>
<html lang="en">
<head>
    
	<title>Vote View</title>
	
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">

	<link rel="shortcut icon" href="docs-assets/ico/favicon.png">
	<link rel="shortcut icon" type="image/ico" href="">

	<link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/webvoteview.css" media="all" rel="stylesheet" type="text/css" />
    <link href="css/map.css" media="all" rel="stylesheet" type="text/css" />
    <link href="css/scatter.css" media="all" rel="stylesheet" type="text/css" />

	<link href="css/bootstrap-theme.min.css" rel="stylesheet">
	<link href="css/jumbotron-narrow.css" rel="stylesheet">
	<link href="css/jquery.dataTables.css" rel="stylesheet">

    <link rel="stylesheet" href="css/app.css">	
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/flexslider.css" type="text/css" media="screen">          
    <link rel="stylesheet" href="css/default.css" id="style_color">
	
    <script src="js/libs/jquery-2.0.3.min.js"></script>
	<script src="js/libs/jquery.sprintf.js"></script> 
	<script src="js/libs/jquery.dataTables.min.js"></script>   
	<script src="js/libs/bootstrap.min.js"></script>
	<script src="js/libs/sprintf.min.js"></script>
 	        
    <script src="js/libs/d3.v3.min.js"></script>
    <script src="js/libs/queue.v1.min.js"></script>
    <script src="js/libs/topojson.v1.min.js"></script>
    <script src="js/map.js"></script>
    <script src="js/scatter.js"></script>
    <script src="js/bar.js"></script>
    <script src="js/webvoteview.js"></script>
	
	<script type="text/javascript" src="js/libs/jquery-migrate-1.2.1.min.js"></script>
	<script type="text/javascript" src="js/libs/jquery.flexslider-min.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/libs/button.js"></script>	

	<script type="text/javascript" charset="utf-8">
  
    // set the page view (there must be much more jquery-ish way to do this!)
	setview = function(v) {
	   switch(v) {
	      case "results":
	          $("#results").show();
	          $("#visualize").hide();
	          $("#search").hide();
	          $("#home").hide();
			  $("#about").hide();
	          break;
	      case "visualize":
	          $("#results").hide();
	          $("#visualize").show();
	          $("#search").hide();
	          $("#home").hide();
			  $("#about").hide();
              break;
	      case "search":
	          $("#results").hide();
	          $("#visualize").hide();
	          $("#search").show();
	          $("#home").hide();
			  $("#about").hide();
              break;
	      case "home":
	          $("#results").hide();
	          $("#visualize").hide();
	          $("#search").hide();
	          $("#home").show();
			  $("#about").hide();
              break;
		  case "about":
	          $("#results").hide();
	          $("#visualize").hide();
	          $("#search").hide();
	          $("#home").hide();
			  $("#about").show();
              break;
	  }
	}

	$(document).ready(function() {
	    setview("home");
	});
	
    var resultids = []; // container for search result ids to use in download

	makeTable = function(query) {
	    var q = encodeURIComponent(query);
	    $('#example').dataTable({
	        "oLanguage": {"sSearch": "Filter results:"},
	        "bProcessing": true,
	        "bDestroy":true,
	        "sAjaxSource": $.sprintf('http://leela.sscnet.ucla.edu/voteview/searchdt?q=%s',q),
	        "aoColumns":[{"mData":"id", "sWidth": "20px", "sTitle":"ID"},
	                       {"mData":"chamber", "sWidth": "10px", "sTitle":"Chamber"},
	                       {"mData":"date", "sWidth": "85px", "sTitle":"Date"},
	                       {"mData":"yea","sTitle":"Vote","sWidth":"80px"},
	                                               {"mData":"descriptionShort", "sWidth": "200px","sTitle":"Description"}],
	        "fnRowCallback": function( nRow, aData, iDisplayIndex ) {
	                                               $('td:eq(0)', nRow).html(
	                            $.sprintf('<a onclick="setviz(\'%s\');setview(\'visualize\')">%s</a>',aData['id'],aData['id'])).attr("title", "Click to explore this vote");
	                                               $('td:eq(3)', nRow).html(
	                            $.sprintf('%s-%s',aData['yea'],aData['no']));
	                            $('td:eq(4)', nRow).attr("title",aData['description']);
                                    resultids.push(aData['id']); // build vector vote ids (nothing to do with the table)
	                            return nRow; },
			
			"fnInitComplete": function(oSettings, json) {
            $('#downloadExcel').click(function() {
                  window.location = 'http://leela.sscnet.ucla.edu/voteview/download?ids=' + resultids.join(); // Make download BUTTON!
            	})   
			}

			});         
	}
	
	searchvotes = function() {
	   $('#example').empty();
	   makeTable($('#qqtext').val());
	};
        
        var wvv;  //not sure if this needs to be in the global env
        setviz = function(id) {
           var chamber = id.substr(0,1);
           var session = parseInt(id.substr(1,3),10);
           var rcnum = parseInt(id.substr(4,7),10);
  	   wvv = new WebVoteView({
                            'chamber': chamber,
                            'session': session,
                            'rcnum': rcnum,
                            'showDescription': true,
                            'bar': {'element': 'bar'},
                            'map': {'element': 'map'},
                            'scatter': {'element': 'scatter'}
                        });
	};
	
	$(function(){
    var $btn = $('#downloadExcel');
	    $btn.click(function(){
        	var $this = $(this);
    	    $this.attr('disabled', 'disabled').html("Loading...");
	        setTimeout(function () {
            	$this.removeAttr('disabled').html('Done!');
        	}, 3000)
    	});
	})

	</script>
	
	</head>
	
	<body>
    
	<div class="container">
		<div class="header">
		<ul class="nav nav-pills pull-right">
          <li><a onclick="setview('home')">Home</a></li>
          <li><a onclick="setview('about')">About Us</a></li>
          <li><a href="jblewis@ucla.edu">Contact</a></li>
        </ul>
      	<h3 class="text-muted">www.voteview.com</h3>
    	</div><!-- container -->
	</div><!-- header -->
	
    <!-- HOME PAGE DIV -->
    <div id="home">
      <div class="jumbotron">
        <h1>VoteView</h1>
        <p class="lead">Search, explore and visualize U.S. Roll Calls</p><p></p>
		<div align="center">
			<a class="btn btn-primary btn-lg" onclick="setview('search')" role="button"><span class="glyphicon glyphicon-search"></span><br>Search</a>
			<a class="btn btn-success btn-lg" onclick="setview('results')" role="button"><span class="glyphicon glyphicon-list"></span><br>Results</a>
			<a class="btn btn-warning btn-lg" onclick="setview('visualize')" role="button"><span class="glyphicon glyphicon-eye-open"></span><br>&#160 View &#160</a>
		</div><!-- buttons -->
      <br>
	</div><!-- jumbotron -->

	<div class="section">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 col-md-4">
            <h3><i class="glyphicon glyphicon-check"></i>&#160 Check this Out!</h3>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>
          </div><!-- ad 1 -->
          <div class="col-lg-4 col-md-4"><!-- HOME PAGE DIV -->
            <h3><i class="glyphicon glyphicon-stats"></i>&#160 Analyze Data</h3>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>
          </div><!-- ad 2 -->
          <div class="col-lg-4 col-md-4">
            <h3><i class="glyphicon glyphicon-thumbs-up"></i>&#160 Publicize It!</h3>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>
          </div><!-- ad 3 -->
        </div><!-- row -->
      </div><!-- container -->
    </div><!-- section -->
	</div><!-- home -->


	<!-- ABOUT -->
	<div id='about'>
		<div class="container">		
			<div class="headline"><h2>Our Awesome Team</h2></div>
				<div class="row team">
					<div class="col-sm-3">
						<div class="thumbnail-style">
							<img class="img-responsive" src="img/team/1.jpg" alt="" />
							<h3><a>Jeff Lewis</a> <small>King and Boss</small></h3>
							<p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, justo sit amet risus etiam porta sem...</p>
							<ul class="list-unstyled list-inline team-socail">
								<li><a href="#"><i class="icon-facebook"></i></a></li>
								<li><a href="#"><i class="icon-twitter"></i></a></li>
								<li><a href="#"><i class="icon-google-plus"></i></a></li>
                			</ul>
            			</div><!-- thumbnail -->
					</div><!-- col-sm-3 -->

        			<div class="col-sm-3">
						<div class="thumbnail-style">
						<img class="img-responsive" src="img/team/3.jpg" alt="" />
                <h3><a>Sir Else</a> <small>Project Manager</small></h3>
                <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, justo sit amet risus etiam porta sem...</p>
                <ul class="list-unstyled list-inline team-socail">
                	<li><a href="#"><i class="icon-facebook"></i></a></li>
                	<li><a href="#"><i class="icon-twitter"></i></a></li>
                	<li><a href="#"><i class="icon-google-plus"></i></a></li>
                </ul>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="thumbnail-style">
                <img class="img-responsive" src="img/team/2.jpg" alt="" />
                <h3><a>Ted Alonso</a> <small>VP of Operations</small></h3>
                <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, justo sit amet risus etiam porta sem...</p>
                <ul class="list-unstyled list-inline team-socail">
                	<li><a href="#"><i class="icon-facebook"></i></a></li>
                	<li><a href="#"><i class="icon-twitter"></i></a></li>
                	<li><a href="#"><i class="icon-google-plus"></i></a></li>
                </ul>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="thumbnail-style">
                <img class="img-responsive" src="img/team/4.jpg" alt="" />
                <h3><a>kobe Bryan</a> <small>Director, R &amp; D Talent</small></h3>
                <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, justo sit amet risus etiam porta sem...</p>
                <ul class="list-unstyled list-inline team-socail">
                	<li><a href="#"><i class="icon-facebook"></i></a></li>
                	<li><a href="#"><i class="icon-twitter"></i></a></li>
                	<li><a href="#"><i class="icon-google-plus"></i></a></li>
                </ul>
            		</div>
        		</div>
		    </div><!--/team-->
			<br>
			
		<div class="row margin-bottom-30">
    			<div class="col-md-6 md-margin-bottom-40">
		            <p>UDonec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>
						
						<blockquote>
							<p>More than 1,000,000 accessed our website in the last 100 years!</p>
							<small>UCLA Dean Bla Bla</small>
						</blockquote>
        		</div><!-- col-md-6 -->
			</div><!-- /row-->
			
		</div><!--/container-->		
    </div>


    <!-- SEARCH PANEL -->
	<div class="container">    
		<div id='search'>
    		<div class="jumbotron">
  				<div class="form-group">
    				<label for="exampleInputEmail1"><h3>Search for Roll Calls</h3></label>
	    			<input type="search" class="form-control" placeholder="Search" id="qqtext" onchange="setview('results');searchvotes()"></input><br>
					<div align="center" data-toggle="buttons">
						<a class="btn btn-primary btn-lg" onclick="setview('search')" role="button"><span class="glyphicon glyphicon-search"></span><br>Search</a>
						<a class="btn btn-success btn-lg" onclick="setview('results')" role="button"><span class="glyphicon glyphicon-list"></span><br>Results</a>
						<a class="btn btn-warning btn-lg" onclick="setview('visualize')" role="button"><span class="glyphicon glyphicon-eye-open"></span><br>&#160 View &#160</a><br>
					</div><!-- buttons -->			
				</div><!-- form -->
     		</div><!-- jumbotron -->
    	</div><!-- search -->
	</div><!-- container -->
	
	
    <!-- RESULTS PANEL -->
    <div id='results'>
		<div class="jumbotron">	
			<div class="container special">
				<div class="table">
					<table id="example" class="table table-striped"></table><br/><br>
					<button id="downloadExcel" type="button" data-loading-text="Loading..." class="btn btn-danger"><span class="glyphicon glyphicon-circle-arrow-down"></span>&#160 Download</button><br/>
					<br/>

					<div align="center" data-toggle="buttons">
						<a class="btn btn-primary btn-lg" onclick="setview('search')" role="button"><span class="glyphicon glyphicon-search"></span><br>Search</a>
						<a class="btn btn-success btn-lg" onclick="setview('results')" role="button"><span class="glyphicon glyphicon-list"></span><br>Results</a>
						<a class="btn btn-warning btn-lg" onclick="setview('visualize')" role="button"><span class="glyphicon glyphicon-eye-open"></span><br>&#160 View &#160</a>
					</div><!-- buttons -->
				</div><!-- table -->
			</div><!-- container -->
			
		</div><!-- jumbotron -->	
    </div><!-- results -->


    <!-- VISUALIZE PANEL -->
    <div id='visualize'>
		
		<div class="container">
    		<div class="panel panel-default">
      			<h1 class="panel-heading" id="wvv-rollcall"></h1><b></b>
			</div>

	        <h2 class="panel-body" id="wvv-description"></h2>

	        <h3 class="panel-body" id="wvv-date"></h3>
	    </div>
	
       <div id="bar"></div>

       <div id="map-container">
         <svg id="map"></svg>
       </div>

       <svg id="scatter" xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>
 
    </div>

 	
	
	<!-- FOOT -->
	<div class="container">    
	<hr>    
	<footer>
      <p>&copy; Jeffrey B. Lewis, 2013</p>
    </footer>
    </div> 


	
  </body>
</html>
