{% extends 'base.html' %}

{% block title %}Roll call{% endblock %}

{% block extra_head %}
    <link href="{{ STATIC_URL }}css/webvoteview.css" media="all" rel="stylesheet" type="text/css" />
    <link href="{{ STATIC_URL }}css/map.css" media="all" rel="stylesheet" type="text/css" />
    <link href="{{ STATIC_URL }}css/scatter.css" media="all" rel="stylesheet" type="text/css" />
    <link href="{{ STATIC_URL }}css/bar.css" media="all" rel="stylesheet" type="text/css" />
{% endblock %}

{% block content %}

{% include 'header.html' %}
<div class="container">

    <div class="row">
        <div class="col-md-12">
        <div id="loading"><img src="{{ STATIC_URL }}img/loading.gif"><h3>Loading...</h3></div>
        <h3 id="wvv-rollcall"></h3>
        <strong id="wvv-date"></strong>
        <p id="wvv-description"></p>


        <div id="map-container">
          <svg id="map"></svg>
        </div>
        <svg id="scatter" xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>
        <div id="bar"></div>

        <script src="{{STATIC_URL}}js/libs/d3.v3.min.js"></script>
        <script src="{{STATIC_URL}}js/libs/queue.v1.min.js"></script>
        <script src="{{STATIC_URL}}js/libs/topojson.v1.min.js"></script>
        <script src="{{STATIC_URL}}js/libs/sprintf.min.js"></script>
        <script src="{{STATIC_URL}}js/webvoteview.js"></script>
        <script src="{{STATIC_URL}}js/map.js"></script>
        <script src="{{STATIC_URL}}js/scatter.js"></script>
        <script src="{{STATIC_URL}}js/bar.js"></script>


        <script>
        // Get the URL parameters
        function getUrlVars() {
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++)
            {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }
        var rc =  getUrlVars()['id'];

        if (rc != undefined){
          var chamber = rc[0];
          var session = parseInt(rc.substr(1,3),10);
          var rcnum = parseInt(rc.substr(4,7),10);
        }
        </script>

        <script>
          var wvv = new WebVoteView({
                                    'chamber': chamber,
                                    'session': session,
                                    'rcnum': rcnum,
                                    'showDescription': true,
                                    'bar': {'element': 'bar'},
                                    'map': {'element': 'map'},
                                    'scatter': {'element': 'scatter'}
                                  });
        </script>
    </div>
    </div>
</div>
{% endblock %}